---
interface SidebarAlbum {
  slug: string;
  name: string;
  items: { thumbUrl?: string }[];
}

interface SidebarTag {
  slug: string;
  label: string;
}

interface SidebarProps {
  albums?: SidebarAlbum[];
  tags?: SidebarTag[];
  activeAlbum?: string | null;
  activeTag?: string | null;
}

const {
  albums = [],
  tags = [],
  activeAlbum = null,
  activeTag = null
} = Astro.props as SidebarProps;
---
<aside class="hidden bg-[var(--surface-sidebar)] border-r border-[var(--border-sidebar)] px-6 py-7 w-72 flex-col gap-6 lg:flex">
  <div class="mx-auto h-28 w-28 overflow-hidden rounded-full border-4 border-[var(--border-avatar)] shadow-[var(--shadow-surface)]">
    <img src={`${import.meta.env.BASE_URL}assets/img/amarantha-avatar.jpg`} alt="Portrait of amarantha with her dog" class="h-full w-full object-cover" />
  </div>
  <nav class="flex flex-col gap-6">
    <div>
      <p class="text-xs uppercase tracking-[0.2em] text-[var(--text-muted)] mb-3">Browse</p>
      <ul class="flex flex-col gap-2">
        <li>
            <a class={`flex items-center gap-2 rounded-md px-4 py-3 text-base font-semibold transition hover:bg-[var(--surface-sidebar-hover)] ${!activeAlbum && !activeTag ? 'bg-[var(--surface-sidebar-active)] text-[var(--accent)]' : ''}`} href={import.meta.env.BASE_URL}>
            <span>All folders</span>
          </a>
        </li>
        {albums.map(album => (
          <li>
            <a
              class={`flex items-center gap-2 rounded-sm px-3 py-2 text-sm font-semibold transition hover:bg-[var(--surface-sidebar-hover)] ${activeAlbum === album.slug ? 'bg-[var(--surface-sidebar-active)] text-[var(--accent)]' : ''}`}
              href={`${import.meta.env.BASE_URL}album/${album.slug}`}
            >
              <span>{album.name}</span>
              <span class="ml-auto text-xs font-medium text-[var(--text-muted)]">{album.items.length}</span>
            </a>
          </li>
        ))}
      </ul>
    </div>
    <div>
      <p class="text-xs uppercase tracking-[0.2em] text-[var(--text-muted)] mb-3">Tags</p>
      <ul class="flex flex-col gap-2">
        {tags.length === 0 && (
          <li class="text-sm text-[var(--text-muted)]">Tags will appear once available.</li>
        )}
        {tags.map(tag => (
          <li>
            <a
              class={`block rounded-sm px-3 py-2 text-sm font-medium transition hover:bg-[var(--surface-sidebar-hover)] ${activeTag === tag.slug ? 'bg-[var(--surface-sidebar-tag)] border border-[var(--border-sidebar-strong)] text-[var(--accent)]' : 'border border-transparent'}`}
              href={`${import.meta.env.BASE_URL}tag/${tag.slug}`}
            >
              {tag.label}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </nav>
</aside>
